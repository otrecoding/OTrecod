<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>OT_joint() — OT_joint • OTrecod</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="OT_joint() — OT_joint"><meta property="og:description" content="The function OT_joint integrates two algorithms called (JOINT) and (R-JOINT) dedicated to the solving of recoding problems in data fusion
using optimal transportation of the joint distribution of outcomes and covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OTrecod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/an-application-of-the-OTrecod-package.html">an-application-of-the-OTrecod-package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>OT_joint()</h1>
    
    <div class="hidden name"><code>OT_joint.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>OT_joint</code> integrates two algorithms called (<code>JOINT</code>) and (<code>R-JOINT</code>) dedicated to the solving of recoding problems in data fusion
using optimal transportation of the joint distribution of outcomes and covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OT_joint</span><span class="op">(</span></span>
<span>  <span class="va">datab</span>,</span>
<span>  index_DB_Y_Z <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  nominal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordinal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convert.num <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convert.class <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist.choice <span class="op">=</span> <span class="st">"E"</span>,</span>
<span>  percent.knn <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  maxrelax <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lambda.reg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  prox.X <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  solvR <span class="op">=</span> <span class="st">"glpk"</span>,</span>
<span>  which.DB <span class="op">=</span> <span class="st">"BOTH"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>datab</dt>
<dd><p>a data.frame made up of two overlayed databases with at least four columns sorted in a random order. One column must be a column dedicated to the identification of the two databases ranked in ascending order
(For example: 1 for the top database and 2 for the database from below, or more logically here A and B  ...But not B and A!). One column (\(Y\) here but other names are allowed)
must correspond to the target variable related to the information of interest to merge with its specific encoding in the database A (corresponding encoding should be missing in the database B). In the same way,
one column (\(Z\) here) corresponds to the second target variable with its specific encoding in the database B (corresponding encoding should be missing in the database A).
Finally, the input database must have at least one shared covariate with same encoding in A and B. Please notice that, if your data.frame has only one shared covariate (four columns) with missing values (because no imputation is desired)
then a warning will appear and the algorithm will only run with complete cases.</p></dd>


<dt>index_DB_Y_Z</dt>
<dd><p>a vector of three indexes of variables. The first index must correspond to the index of the databases identifier column. The second index corresponds
to the index of the target variable in the first database (A) while the third index corresponds to the column index related to the target variable in the second database (B).</p></dd>


<dt>nominal</dt>
<dd><p>a vector of column indexes of all the nominal (not ordered) variables (database identifier and target variables included if it is the case for them).</p></dd>


<dt>ordinal</dt>
<dd><p>a vector of column indexes of all the ordinal variables (database identifier and target variables included if it is the case for them).</p></dd>


<dt>logic</dt>
<dd><p>a vector of column indexes of all the boolean variables of the data.frame.</p></dd>


<dt>convert.num</dt>
<dd><p>indexes of the continuous (quantitative) variables. They will be automatically converted in ordered factors. By default, no continuous variables is assumed in the database.</p></dd>


<dt>convert.class</dt>
<dd><p>a vector indicating for each continuous variable to convert, the corresponding desired number of levels. If the length of the argument <code>convert_num</code> exceeds 1 while the length of <code>convert_class</code> equals 1 (only one integer),
each discretization will count the same number of levels (quantiles).</p></dd>


<dt>dist.choice</dt>
<dd><p>a character string (with quotes) corresponding to the distance function chosen between: the euclidean distance ("E", by default), the Manhattan distance ("M"),
the Gower distance ("G"), and the Hamming distance ("H") for binary covariates only.</p></dd>


<dt>percent.knn</dt>
<dd><p>the ratio of closest neighbors involved in the computations of the cost matrices. 1 is the default value that includes all rows in the computation.</p></dd>


<dt>maxrelax</dt>
<dd><p>the maximum percentage of deviation from expected probability masses. It must be equal to 0 (default value) for the <code>JOINT</code> algorithm, and equal to a strictly positive value for the R-JOINT algorithm.</p></dd>


<dt>lambda.reg</dt>
<dd><p>a coefficient measuring the importance of the regularization term. It corresponds to the <code>R-JOINT</code> algorithm for a value other than 0 (default value).</p></dd>


<dt>prox.X</dt>
<dd><p>a probability (betwen 0 and 1) used to calculate the distance threshold below which two covariates' profiles are supposed as neighbors.
If <code>prox.X = 1</code>, all profiles are considered as neighbors.</p></dd>


<dt>solvR</dt>
<dd><p>a character string that specifies the type of method selected to solve the optimization algorithms. The default solver is "glpk".</p></dd>


<dt>which.DB</dt>
<dd><p>a character string indicating the database to complete ("BOTH" by default, for the prediction of \(Y\) and \(Z\) in the two databases), "A" only for the imputation of \(Z\) in A, "B" only for the imputation of \(Y\) in B.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A "otres" class object of 9 elements:</p>
<dl><dt>time_exe</dt>
<dd><p>running time of the function</p></dd>

    <dt>gamma_A</dt>
<dd><p>estimate of \(\gamma\) for the completion of A. A matrix that corresponds to the joint distribution of \((Y,Z,X)\) in A</p></dd>

    <dt>gamma_B</dt>
<dd><p>estimate of \(\gamma\) for the completion of B. A matrix that corresponds to the joint distribution of \((Y,Z,X)\) in B</p></dd>

    <dt>profile</dt>
<dd><p>a data.frame that gives all details about the remaining P profiles of covariates. These informations can be linked to the <code>estimatorZA</code> and the <code>estimatorYB</code> objects for a better interpretation of the results.</p></dd>

    <dt>res_prox</dt>
<dd><p>a <code>proxim_dist</code> object</p></dd>

    <dt>estimatorZA</dt>
<dd><p>an array that corresponds to estimates of the probability distribution of \(Z\) conditional to \(X\) and \(Y\) in database A. The number of rows of each table corresponds to the total number of profiles of covariates.
    The first dimension of each table (rownames) correspond to the profiles of covariates sorted by order of appearance in the merged database. The second dimension of the array (columns of the tables) corresponds to the levels of \(Y\) while the third element corresponds to the levels of \(Z\).</p></dd>

    <dt>estimatorYB</dt>
<dd><p>an array that corresponds to estimates of the probability distribution of \(Y\) conditional to \(X\) and \(Z\) in database B. The number of rows of each table corresponds to the total number of profiles of covariates.
    The first dimension of each table (rownames) correspond to the profiles of covariates sorted by order of appearance in the merged database. The second dimension of the array (columns of the tables) corresponds to the levels of \(Z\) while the third element corresponds to the levels of \(Y\).</p></dd>

    <dt>DATA1_OT</dt>
<dd><p>the database A with the individual predictions of \(Z\) using an optimal transportation algorithm (<code>JOINT</code>) or <code>R-JOINT</code></p></dd>

    <dt>DATA2_OT</dt>
<dd><p>the database B with the individual predictions of \(Y\) using an optimal transportation algorithm (<code>JOINT</code>) or <code>R-JOINT</code></p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>A. THE RECODING PROBLEM IN DATA FUSION</p>
<p>Assuming that \(Y\) and \(Z\) are two target variables which refered to the same target population in two separate databases A and B respectively (no overlapping rows),
so that \(Y\) and \(Z\) are never jointly observed. Assuming also that A and B share a subset of common covariates \(X\) of any types (same encodings in A and B)
completed or not. Merging these two databases often requires to solve a recoding problem by creating an unique database where
the missing information of \(Y\) and \(Z\) is fully completed.</p>

<p>B. INFORMATIONS ABOUT THE ALGORITHM</p>
<p>As with the function <code><a href="OT_outcome.html">OT_outcome</a></code>, the function <code>OT_joint</code> provides a solution to the recoding problem by proposing an
application of optimal transportation which aims is to search for a bijective mapping between the joint distributions of \((Y,X)\) and \((Z,X)\) in A and B (see (2) for more details).
The principle of the algorithm is also based on the resolution of an optimization problem, which provides a solution \(\gamma\) (as called in (1) and (2)), estimate
of the joint distribution of \((X,Y,Z)\) according to the database to complete (see the argument <code>which.DB</code> for the choice of the database). While the algorithms <code>OUTCOME</code> and <code>R_OUTCOME</code> integrated in
the function <code><a href="OT_outcome.html">OT_outcome</a></code> require post-treatment steps to provide individual predictions, the algorithm <code>JOINT</code> directly uses estimations of the conditional distributions \((Y|Z,X)\) in B and
\((Z|Y,X)\) in A to predict the corresponding incomplete individuals informations of \(Y\) and/or \(Z\) respectively.
This algorithm supposes that the conditional distribution \((Y|X)\) must be identical in A and B. Respectively, \((Z|X)\) is supposed identical in A and B.
Estimations a posteriori of conditional probabilities \(P[Y|X,Z]\) and \(P[Z|X,Y]\) are available for each profiles of covariates in output (See the objects <code>estimatorYB</code> and <code>estimatorZA</code>).
Estimations of \(\gamma\) are also available according to the chosen transport distributions (See the arguments <code>gamma_A</code> and <code>gamma_B</code>).</p>
<p>The algorithm <code>R-JOINT</code> gathers enrichments of the algorithm <code>JOINT</code> and is also available via the function <code>OT_joint</code>. It allows users to add a relaxation term in the algorithm to relax distributional assumptions (<code>maxrelax</code>&gt;0),
and (or) add also a positive regularization term (<code>lamdba.reg</code>&gt;0) expressing that the transportation map does not vary to quickly with respect of covariates \(X\).
Is is suggested to users to calibrate these two parameters a posteriori by studying the stability of the individual predictions in output.</p>

<p>C. EXPECTED STRUCTURE FOR THE INPUT DATABASE</p>
<p>The input database is a data.frame that must satisfy a specific form:</p><ul><li><p>Two overlayed databases containing a common column of databases identifiers (A and B, 1 or 2, by examples, encoded in numeric or factor form)</p></li>
<li><p>A column corresponding to the target variable with its specific encoding in A (For example a factor \(Y\) encoded in \(n_Y\) levels, ordered or not, with NAs in the corresponding rows of B)</p></li>
<li><p>A column corresponding to another target outcome summarizing the same latent information with its specific encoding in B (By example a factor \(Z\) with \(n_Z\) levels, with NAs in rows of A)</p></li>
<li><p>The order of the variables in the database have no importance but the column indexes related to the three columns previously described (ie ID, \(Y\) and \(Z\)) must be rigorously specified
in the argument <code>index_DB_Y_Z</code>.</p></li>
<li><p>A set of shared common categorical covariates (at least one but more is recommended) with or without missing values (provided that the number of covariates exceeds 1) is required. On the contrary to the
function <code>OT_outcome</code>, please notice, that the function <code>OT_joint</code> does not accept continuous covariates therefore these latters will have to be categorized beforehand or using the provided input process (see <code>convert.num</code>).</p></li>
</ul><p>The function <code><a href="merge_dbs.html">merge_dbs</a></code> is available in this package to assist user in the preparation of their databases.</p>
<p>Remarks about the target variables:</p><ul><li><p>A target variable can be of categorical type, but also discrete, stored in factor, ordered or not. Nevertheless, notice that, if the variable is stored in numeric it will be automatically converted in ordered factors.</p></li>
<li><p>If a target variable is incomplete, the corresponding rows will be automatically dropped during the execution of the function.</p></li>
</ul><p>The type of each variables (including \(ID\), \(Y\) and \(Z\)) of the database must be rigorously specified, in one of the four arguments <code>quanti</code>, <code>nominal</code>, <code>ordinal</code> and <code>logic</code>.</p>

<p>D. TRANSFORMATIONS OF CONTINUOUS COVARIATES</p>
<p>Continuous shared variables (predictors) with infinite numbers of values have to be categorized before being introduced in the function.
To assist users in this task, the function <code>OT_joint</code> integrates in its syntax a process dedicated to the categorization of continuous covariates. For this, it is necessary to rigorously fill in
the arguments <code>quanti</code> and <code>convert.class</code>.
The first one informs about the column indexes of the continuous variables to be transformed in ordered factor while the second one specifies the corresponding number of desired balanced levels (for unbalanced levels, users must do transformations by themselves).
Therefore <code>convert.num</code> and <code>convert.class</code> must be vectors of same length, but if the length of <code>quanti</code> exceeds 1, while the length of <code>convert.class</code> is 1, then, by default, all the covariates to convert will have the same number of classes (transformation by quantiles),
that corresponds to the value specified in the argument <code>convert.class</code>.
Notice that only covariates can be transformed (not target variables) and that any incomplete information must have been taken into account beforehand (via the dedicated functions <code><a href="merge_dbs.html">merge_dbs</a></code> or <code><a href="imput_cov.html">imput_cov</a></code> for examples).
Moreover, all the indexes informed in the argument <code>convert.num</code> must also be informed in the argument <code>quanti</code>.
Finally, it is recommended to declare all discrete covariates as ordinal factors using the argument <code>ordinal</code>.</p>

<p>E. INFORMATIONS ABOUT DISTANCE FUNCTIONS AND RELATED PARAMETERS</p>
<p>Each individual (or row) of a given database is here characterized by a vector of covariates, so the distance between two individuals or groups of individuals depends on similarities between covariates
according to the distance function chosen by user (via the argument <code>dist.choice</code>). Actually four distance functions are implemented in <code>OT_joint</code> to take into account the most frequently encountered situation (see (3)):</p><ul><li><p>the Manhattan distance ("M")</p></li>
<li><p>the Euclidean distance ("E")</p></li>
<li><p>the Gower distance for mixed data (see (4): "G")</p></li>
<li><p>the Hamming distance for binary data ("H")</p></li>
</ul><p>Finally, two profiles of covariates \(P_1\) (\(n_1\) individuals) and \(P_2\) (\(n_2\) individuals) will be considered as neighbors if \(dist(P_1,P_2) &lt; prox.X \times max(dist(P_i,P_j))\) where \(prox.X\) must be fixed by user (\(i = 1,\dots,n_1\) and \(j = 1,\dots,n_2\)). This choice is used in the computation of the <code>JOINT</code> and <code>R_JOINT</code> algorithms.
The <code>prox.X</code> argument influences a lot the running time of the algorithm. The greater, the more the value will be close to 1, the more the convergence of the algorithm will be difficult or even impossible.</p>
<p>Each individual \(i\) from A or B is here considered as a neighbor of only one profile of covariates \(P_j\).</p>

<p>F. INFORMATIONS ABOUT THE SOLVER</p>
<p>The argument <code>solvR</code> permits user to choose the solver of the optimization algorithm. The default solver is "glpk" that corresponds to the GNU Linear Programming Kit (see (5) for more details).
Moreover, the function actually uses the <code>R</code> optimization infrastructure of the package <span class="pkg">ROI</span> which offers a wide choice of solver to users by easily loading the associated plugins of <span class="pkg">ROI</span> (see (6)).</p>
<p>For more details about the algorithms integrated in <code>OT_joint</code>, please consult (2).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>Gares V, Dimeglio C, Guernec G, Fantin F, Lepage B, Korosok MR, savy N (2019). On the use of optimal transportation theory to recode variables and application to database merging. The International Journal of Biostatistics.
Volume 16, Issue 1, 20180106, eISSN 1557-4679. doi:10.1515/ijb-2018-0106</p></li>
<li><p>Gares V, Omer J (2020) Regularized optimal transport of covariates and outcomes in data recoding. Journal of the American Statistical Association. <a href="https://doi.org/10.1080/01621459.2020.1775615" class="external-link">doi:10.1080/01621459.2020.1775615</a></p></li>
<li><p>Anderberg, M.R. (1973), Cluster analysis for applications, 359 pp., Academic Press, New York, NY, USA.</p></li>
<li><p>Gower J.C. (1971). A general coefficient of similarity and some of its properties. Biometrics, 27, 623–637</p></li>
<li><p>Makhorin A (2011). GNU Linear Programming Kit Reference Manual Version 4.47.<a href="http://www.gnu.org/software/glpk/" class="external-link">http://www.gnu.org/software/glpk/</a></p></li>
<li><p>Theussl S, Schwendinger F, Hornik K (2020). ROI: An Extensible R Optimization Infrastructure.Journal of Statistical Software,94(15), 1-64. <a href="https://doi.org/10.18637/jss.v094.i15" class="external-link">doi:10.18637/jss.v094.i15</a></p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="merge_dbs.html">merge_dbs</a></code>, <code><a href="OT_outcome.html">OT_outcome</a></code>, <code><a href="proxim_dist.html">proxim_dist</a></code>, <code><a href="avg_dist_closest.html">avg_dist_closest</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gregory Guernec, Valerie Gares, Jeremy Omer</p>
<p><a href="mailto:otrecod.pkg@gmail.com">otrecod.pkg@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### An example of JOINT algorithm with:</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span><span class="co"># - A sample of the database tab_test</span></span></span>
<span class="r-in"><span><span class="co"># - Y1 and Y2 are a 2 outcomes encoded in 2 different forms in DB 1 and 2:</span></span></span>
<span class="r-in"><span><span class="co">#   4 levels for Y1 and 3 levels for Y2</span></span></span>
<span class="r-in"><span><span class="co"># - n1 = n2 = 40</span></span></span>
<span class="r-in"><span><span class="co"># - 2 discrete covariates X1 and X2 defined as ordinal</span></span></span>
<span class="r-in"><span><span class="co"># - Distances estimated using the Gower function</span></span></span>
<span class="r-in"><span><span class="co"># Predictions are assessed for Y1 in B only</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tab_test</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tab_test2</span> <span class="op">&lt;-</span> <span class="va">tab_test</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">5001</span><span class="op">:</span><span class="fl">5040</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">OUTJ1_B</span> <span class="op">&lt;-</span> <span class="fu">OT_joint</span><span class="op">(</span><span class="va">tab_test2</span>,</span></span>
<span class="r-in"><span>                    nominal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ordinal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    dist.choice <span class="op">=</span> <span class="st">"G"</span>, which.DB <span class="op">=</span> <span class="st">"B"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OT JOINT PROCEDURE in progress ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type                  = JOINT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distance              = Gower</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Percent closest       = 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Relaxation term       = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regularization term   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation tol cov   = 0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DB imputed            = B</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Y"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 remaining levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 remaining levels</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### An example of R-JOINT algorithm using the previous database,</span></span></span>
<span class="r-in"><span><span class="co">### and keeping the same options excepted for:</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span><span class="co"># - The distances are estimated using the Gower function</span></span></span>
<span class="r-in"><span><span class="co"># - Inclusion of an error term in the constraints on</span></span></span>
<span class="r-in"><span><span class="co">#   the marginals (relaxation term)</span></span></span>
<span class="r-in"><span><span class="co"># Predictions are assessed for Y1 AND Y2 in A and B respectively</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">R_OUTJ1</span> <span class="op">&lt;-</span> <span class="fu">OT_joint</span><span class="op">(</span><span class="va">tab_test2</span>,</span></span>
<span class="r-in"><span>                    nominal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ordinal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    dist.choice <span class="op">=</span> <span class="st">"G"</span>, maxrelax <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>                    which.DB <span class="op">=</span> <span class="st">"BOTH"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OT JOINT PROCEDURE in progress ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type                  = R-JOINT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distance              = Gower</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Percent closest       = 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Relaxation term       = 0.4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regularization term   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation tol cov   = 0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DB imputed            = BOTH</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Y"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 remaining levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 remaining levels</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### The previous example of R-JOINT algorithm with:</span></span></span>
<span class="r-in"><span><span class="co"># - Adding a regularization term</span></span></span>
<span class="r-in"><span><span class="co"># Predictions are assessed for Y1 and Y2 in A and B respectively</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">R_OUTJ2</span> <span class="op">&lt;-</span> <span class="fu">OT_joint</span><span class="op">(</span><span class="va">tab_test2</span>,</span></span>
<span class="r-in"><span>                    nominal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ordinal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    dist.choice <span class="op">=</span> <span class="st">"G"</span>, maxrelax <span class="op">=</span> <span class="fl">0.4</span>, lambda.reg <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                    which.DB <span class="op">=</span> <span class="st">"BOTH"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OT JOINT PROCEDURE in progress ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type                  = R-JOINT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distance              = Gower</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Percent closest       = 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Relaxation term       = 0.4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regularization term   = 0.9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation tol cov   = 0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DB imputed            = BOTH</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Y"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 remaining levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 remaining levels</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Another example of JOINT algorithm with:</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span><span class="co"># - A sample of the database simu_data</span></span></span>
<span class="r-in"><span><span class="co"># - Y1 and Y2 are a 2 outcomes encoded in 2 different forms in DB A and B:</span></span></span>
<span class="r-in"><span><span class="co">#   (3 levels for Y and 5 levels for Z)</span></span></span>
<span class="r-in"><span><span class="co"># - n1 = n2 = 100</span></span></span>
<span class="r-in"><span><span class="co"># - 3 covariates: Gender, Smoking and Age in a qualitative form</span></span></span>
<span class="r-in"><span><span class="co"># - Complete Case study</span></span></span>
<span class="r-in"><span><span class="co"># - The Hamming distance</span></span></span>
<span class="r-in"><span><span class="co"># Predictions are assessed for Y1 and Y2 in A and B respectively</span></span></span>
<span class="r-in"><span><span class="co">#-----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simu_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">simu_data2</span> <span class="op">&lt;-</span> <span class="va">simu_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">401</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">simu_data3</span> <span class="op">&lt;-</span> <span class="va">simu_data2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">simu_data2</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">OUTJ2</span> <span class="op">&lt;-</span> <span class="fu">OT_joint</span><span class="op">(</span><span class="va">simu_data3</span>,</span></span>
<span class="r-in"><span>                  convert.num <span class="op">=</span> <span class="fl">6</span>, convert.class <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                  nominal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ordinal <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>                  dist.choice <span class="op">=</span> <span class="st">"H"</span>, which.DB <span class="op">=</span> <span class="st">"BOTH"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OT JOINT PROCEDURE in progress ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type                  = JOINT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Distance              = Hamming</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Percent closest       = 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Relaxation term       = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regularization term   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation tol cov   = 0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DB imputed            = BOTH</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 remaining levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Hamming 1/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Hamming 2/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Hamming 3/3</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Guernec, Valerie Gares.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

