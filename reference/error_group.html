<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>error_group() — error_group • OTrecod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="error_group() — error_group" />
<meta property="og:description" content="This function studies the association between two categorical distributions with different numbers of modalities." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OTrecod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/an-application-of-the-OTrecod-package.html">an-application-of-the-OTrecod-package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>error_group()</h1>
    
    <div class="hidden name"><code>error_group.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function studies the association between two categorical distributions with different numbers of modalities.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>error_group</span><span class='op'>(</span><span class='va'>REF</span>, <span class='va'>Z</span>, ord <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>REF</th>
      <td><p>a factor with a reference number of levels.</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>a factor with a number of levels greater than the number of levels of the reference.</p></td>
    </tr>
    <tr>
      <th>ord</th>
      <td><p>a boolean. If TRUE, only neighboring levels of \(Z\) will be grouped and tested together.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with five columns:</p>
<dt>combi</dt><dd><p>the first column enumerates all possible groups of modalities of \(Y\) to obtain the same number of levels as the reference.</p></dd>
        <dt>error_rate</dt><dd><p>the second column gives the corresponding rate error from the confusion matrix (ratio of non-diagonal elements)</p></dd>
        <dt>Kappa</dt><dd><p>this column indicates the result of the Cohen's kappa coefficient related to each combination of \(Y\)</p></dd>
        <dt>Vcramer</dt><dd><p>this column indicates the result of the Cramer's V criterion related to each combination of \(Y\)</p></dd>
        <dt>RankCor</dt><dd><p>this column indicates the result of the Spearman's coefficient of correlation related to each combination of \(Y\)</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Assuming that \(Y\) and \(Z\) are categorical variables summarizing a same information, and that one of the two related encodings is unknown by user
because this latter is, for example, the result of predictions provided by a given model or algorithm, the function <code>error_group</code> searches for potential links between the modalities of \(Y\) to approach at best the distribution of \(Z\).</p>
<p>Assuming that \(Y\) and \(Z\) have \(n_Y\) and \(n_Z\) modalities respectively so that \(n_Y &gt; n_Z\), in a first step, the
function <code>error_group</code> combines modalities of \(Y\) to build all possible variables \(Y'\) verifying  \(n_{Y'} = n_Z\).
In a second step, the association between \(Z\) and each new variable \(Y'\) generated is measured by studying the ratio of concordant pairs related to the confusion matrix but also using standard criterions:
the Cramer's V (1), the Cohen's kappa coefficient (2) and the Spearman's rank correlation coefficient.</p>
<p>According to the type of \(Y\), different combinations of modalities are tested:</p><ul>
<li><p>If \(Y\) and \(Z\) are ordinal (<code>ord = TRUE</code>), only consecutive modalities of \(Y\) will be grouped to build the variables \(Y'\).</p></li>
<li><p>If \(Y\) and \(Z\) are nominal (<code>ord = FALSE</code>), all combinations of modalities of \(Y\) (consecutive or not) will be grouped to build the variables \(Y'\).</p></li>
</ul>

<p>All the associations tested are listed in output as a data.frame object.
The function <code>error_group</code> is directly integrated in the function <code><a href='verif_OT.html'>verif_OT</a></code> to evaluate the proximity of two multinomial distributions, when one of them is estimated from the predictions of an OT algorithm.</p>
<p>Example:
Assuming that \(Y = (1,1,2,2,3,3,4,4)\) and \(Z = (1,1,1,1,2,2,2,2)\), so \(n_Y = 4\) and \(n_Z = 2\) and the related coefficient of correlation \(cor(Y,Z)\) is 0.89.
Are there groupings of modalities of \(Y\) which contribute to improving the proximity between \(Y\) and \(Z\) ?
From \(Y\), the function <code>error_group</code> gives an answer to this question by successively constructing the variables: \(Y_1 = (1,1,1,1,2,2,2,2)\), \(Y_2 = (1,1,2,2,1,1,2,2)\), \(Y_3 = (1,1,2,2,2,2,1,1)\)
and tests \(\mbox{cor}(Z,Y_1) = 1\), \(\mbox{cor}(Z,Y_2) = 0\), \(\mbox{cor}(Z,Y_3) = 0\).
Here, the tests permit to conclude that the difference of encodings between \(Y\) and \(Z\) resulted in fact in a simple grouping of modalities.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Cramér, Harald. (1946). Mathematical Methods of Statistics. Princeton: Princeton University Press.</p></li>
<li><p>McHugh, Mary L. (2012). Interrater reliability: The kappa statistic. Biochemia Medica. 22 (3): 276–282</p></li>
</ol>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Gregory Guernec</p>
<p><a href='mailto:otrecod.pkg@gmail.com'>otrecod.pkg@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'># Basic examples:</span></span>
<span class='r-in'><span class='va'>Z1</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>,<span class='fl'>50</span>,replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Z1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 50</span>
<span class='r-in'><span class='va'>Z3</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>,<span class='fl'>50</span>,replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Z3</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 50</span>
<span class='r-in'><span class='va'>Z2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"B"</span>,<span class='st'>"C"</span>,<span class='st'>"D"</span><span class='op'>)</span>,<span class='fl'>50</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Z2</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 50</span>
<span class='r-in'><span class='va'>Z4</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"B"</span>,<span class='st'>"C"</span>,<span class='st'>"D"</span>,<span class='st'>"E"</span><span class='op'>)</span>,<span class='fl'>50</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Z4</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 50</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># By only grouping consecutive levels of Z1:</span></span>
<span class='r-in'><span class='fu'>error_group</span><span class='op'>(</span><span class='va'>Z1</span>,<span class='va'>Z4</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       combi error_rate  Kappa Vcramer RankCor</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 A/B/C D E         56  0.156    0.21   0.249</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6 A/B C/D E         58  0.116    0.19   0.213</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5 A B/C/D E         62  0.086    0.19   0.203</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 A/B C D/E         68 -0.051    0.23   0.209</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 A B/C D/E         72 -0.076    0.26   0.208</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 A B C/D/E         74 -0.077    0.25   0.146</span>
<span class='r-in'><span class='co'># By only all possible levels of Z1, consecutive or not:</span></span>
<span class='r-in'><span class='fu'>error_group</span><span class='op'>(</span><span class='va'>Z3</span>,<span class='va'>Z1</span>,<span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   combi error_rate  Kappa Vcramer RankCor</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 1 2/3         46  0.068    0.03   0.071</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 1/2 3         52 -0.022    0.00  -0.025</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 1 3/2         54 -0.090    0.05  -0.092</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># \donttest{</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>### using a sample of the tab_test object (3 complete covariates)</span></span>
<span class='r-in'><span class='co'>### Y1 and Y2 are a same variable encoded in 2 different forms in DB 1 and 2:</span></span>
<span class='r-in'><span class='co'>### (4 levels for Y1 and 3 levels for Y2)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>tab_test</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Example with n1 = n2 = 70 and only X1 and X2 as covariates</span></span>
<span class='r-in'><span class='va'>tab_test2</span> <span class='op'>=</span> <span class='va'>tab_test</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>70</span>,<span class='fl'>5001</span><span class='op'>:</span><span class='fl'>5070</span><span class='op'>)</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>### An example of JOINT model (Manhattan distance)</span></span>
<span class='r-in'><span class='co'># Suppose we want to impute the missing parts of Y1 in DB2 only ...</span></span>
<span class='r-in'><span class='va'>try1J</span> <span class='op'>=</span> <span class='fu'><a href='OT_joint.html'>OT_joint</a></span><span class='op'>(</span><span class='va'>tab_test2</span>, nominal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>, ordinal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>,</span>
<span class='r-in'>                 dist.choice <span class='op'>=</span> <span class='st'>"M"</span>, which.DB <span class='op'>=</span> <span class='st'>"B"</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ---------------------------------------</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> OT JOINT PROCEDURE in progress ...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ---------------------------------------</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Type                  = JOINT</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Distance              = Manhattan</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Percent closest       = 100%</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Relaxation term       = 0</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Regularization term   = 0</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Aggregation tol cov   = 0.1</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> DB imputed            = B</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ---------------------------------------</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Your target DB[, "Y"] was numeric ... By default, it has been converted in factor of integers</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> 4 remaining levels</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> 3 remaining levels</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Error rates between Y2 and the predictions of Y1 in the DB 2</span></span>
<span class='r-in'><span class='co'># by grouping the levels of Y1:</span></span>
<span class='r-in'><span class='fu'>error_group</span><span class='op'>(</span><span class='va'>try1J</span><span class='op'>$</span><span class='va'>DATA2_OT</span><span class='op'>$</span><span class='va'>Z</span>,<span class='va'>try1J</span><span class='op'>$</span><span class='va'>DATA2_OT</span><span class='op'>$</span><span class='va'>OTpred</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     combi error_rate  Kappa Vcramer RankCor</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 1/2/3 4       47.1  0.286    0.68   0.844</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 1 2/3/4       60.0  0.098    0.95   0.664</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 1/2 3/4       82.9 -0.182    0.74   0.316</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>try1J</span><span class='op'>$</span><span class='va'>DATA2_OT</span><span class='op'>$</span><span class='va'>Z</span>,<span class='va'>try1J</span><span class='op'>$</span><span class='va'>DATA2_OT</span><span class='op'>$</span><span class='va'>OTpred</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      1  2  3  4</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1 12 16  0  0</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2  2  0  0 15</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3  0  0 25  0</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># }</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Gregory Guernec, Valerie Gares.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


